<!DOCTYPE html>
<html lang="en-us">
<head>
    <title>Generating Certificates of Attendance Using R &middot; Data Science Unplugged</title>
    <meta name="generator" content="Hugo 0.30.2" />
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="author" content="Data Science Unplugged">
    
      <meta name="description" content="Sometimes after an event you need to issue certificates to the participants. How do you normally produce several certificates automatically? There are different ways to do it and here we share our approach after a recent community event. We used R to automatically generate the certificates using R markdown and LaTeX language.">
    
    
    <link rel="canonical" href="/blog/creating-certificates-of-attendance-using-r/"/>
    <link rel="icon" href="/logo.png">
    <link rel="logo" href="/logo.png"/>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/font-awesome.min.css">
    <link rel="stylesheet" href="/css/monokai.css">
    <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
    
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400italic,400,600' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Source+Code+Pro' rel='stylesheet' type='text/css'>
    <meta property="og:title" content="Generating Certificates of Attendance Using R" />
<meta property="og:description" content="Sometimes after an event you need to issue certificates to the participants. How do you normally produce several certificates automatically? There are different ways to do it and here we share our approach after a recent community event. We used R to automatically generate the certificates using R markdown and LaTeX language." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://www.dsup.org/blog/creating-certificates-of-attendance-using-r/" />

  <meta property="og:image" content="http://www.dsup.org/Example_Certificate.png" />



<meta property="article:published_time" content="2018-02-20T00:00:00&#43;00:00"/>

<meta property="article:modified_time" content="2018-02-20T00:00:00&#43;00:00"/>











    
    
<meta itemprop="name" content="Generating Certificates of Attendance Using R">
<meta itemprop="description" content="Sometimes after an event you need to issue certificates to the participants. How do you normally produce several certificates automatically? There are different ways to do it and here we share our approach after a recent community event. We used R to automatically generate the certificates using R markdown and LaTeX language.">


<meta itemprop="datePublished" content="2018-02-20T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2018-02-20T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="620">

  <meta itemprop="image" content="http://www.dsup.org/Example_Certificate.png">



<meta itemprop="keywords" content="Data Science,events,R markdown,LaTeX,R language," />

    <meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image:src" content="http://www.dsup.org/Example_Certificate.png"/>
<meta name="twitter:title" content="Generating Certificates of Attendance Using R"/>
<meta name="twitter:description" content="Sometimes after an event you need to issue certificates to the participants. How do you normally produce several certificates automatically? There are different ways to do it and here we share our approach after a recent community event. We used R to automatically generate the certificates using R markdown and LaTeX language."/>
<meta name="twitter:site" content="@dsup_lx"/>

    <script src="https://use.fontawesome.com/304670a398.js"></script>

    

    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
</head>
<body>
<div class="container">


<div id="container">
	<header id="header">
  <div id="header-main" class="header-inner">
    <div class="outer">
      <a href="http://www.dsup.org/" id="logo">
          
          <span class="site-title">Data Science Unplugged</span>
      </a>
      <nav id="main-nav">
          
          
          
          
          

          
          <a class="main-nav-link" href="/about/">About</a>
          
          <a class="main-nav-link" href="/2018/02/14/resources/">Resources</a>
          

          
          
          <a class="main-nav-link" href="/events/">Events</a>
          
          
          
          <a class="main-nav-link" href="/blog/">Blog</a>
          
          
      </nav>
        <nav id="sub-nav">
          <div class="profile" id="profile-nav">
            <a id="profile-anchor" href="javascript:;"><img class="avatar" src="/css/images/logo.png"><i class="fa fa-caret-down"></i></a>
          </div>
        </nav>
        <div id="search-form-wrap">
          <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form">
              <input type="search" name="q" class="search-form-input" placeholder="Search">
              <button type="submit" class="search-form-submit">
              </button>
              <input type="hidden" name="sitesearch" value="http://www.dsup.org/" />
         </form>
        </div>
    </div>
  </div>
  <div id="main-nav-mobile" class="header-sub header-inner">
    <table class="menu outer">
      <tbody>
          <tr>
          
          
          
          
          

          
          <td><a class="main-nav-link" href="/about/">About</a></td>
          
          <td><a class="main-nav-link" href="/2018/02/14/resources/">Resources</a></td>
          

          
          
          <td><a class="main-nav-link" href="/events/">Events</a></td>
          
          
          
          <td><a class="main-nav-link" href="/blog/">Blog</a></td>
          
          
          <td>
          <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form">
          <input type="search" name="q" class="search-form-input" placeholder="Search">
          <input type="hidden" name="sitesearch" value="http://www.dsup.org/" />
          </form>
        </td>
      </tr>
      </tbody>
    </table>
  </div>
</header>

   	
   	<div class="outer">
   	
    	<aside id="profile">
  <div class="inner profile-inner">
    <div class="base-info profile-block">
      
      <img id="avatar" src="/css/images/logo.png">
      
      <h2 id="name">Data Science Unplugged</h2>
      <h3 id="title">A community for data science</h3>
      <span id="location"><i class="fa fa-map-marker"></i>Lisbon</span>
      
          <a id="follow" href="https://twitter.com/dsup_lx">
              Follow
          </a>
      
    </div>
    <div class="article-info profile-block">
      <div class="article-info-block">
        1
        <span>Posts</span>
      </div>
      <div class="article-info-block">
        
          9
        
        <span>
            Tags
        </span>
      </div>
    </div>
    <div class="profile-block social-links">
      <table>
        <tr>
          
<td><a href="//github.com/dsup" target="_blank" title="GitHub"><i class="fa fa-github"></i></a></td>



<td><a href="//meetup.com/Data-Science-Unplugged" target="_blank" title="Meetup"><i class="fa fa-meetup"></i></a></td>





















<td><a href="//youtu.be/AuAzc7doWhk" target="_blank" title="YouTube"><i class="fa fa-youtube"></i></a></td>





























<td><a href="//twitter.com/dsup_lx" target="_blank" title="Twitter"><i class="fa fa-twitter"></i></a></td>


          <td><a href="http://www.dsup.org/index.xml" target="_blank" title="RSS"><i class="fa fa-rss"></i></a></td>
        </tr>
      </table>
    </div>
  </div>
</aside>

    

    <section id="main">
    
    <article id="page-undefined" class="article article-type-page" itemscope="" itemprop="blogPost">
    <div class="article-inner">
        
            <img src="/banners/Example_Certificate.png" class="article-banner">
        

        <header class="article-header">
    <a href="/blog/creating-certificates-of-attendance-using-r/">
    <h1 class="article-title" itemprop="name">
        Generating Certificates of Attendance Using R
    </h1>
    </a>
    <div class="article-meta">

        
        <div class="article-date">
            <i class="fa fa-calendar"></i>
            <time datetime="2018-02-20 00:00:00 &#43;0000 UTC" itemprop="datePublished">2018-02-20</time>
            &middot;
            620
            words
            &middot;
            3
            minute read
        </div>
        
        
            
            
            <div class="article-category">
                <i class="fa fa-folder"></i>
                
                
                <a class="article-category-link" href="/categories/blog">Blog</a>
                
                
            </div>
            
        

        
            
            
            <div class="article-category">
                <i class="fa fa-tags"></i>
                
                
                <a class="article-category-link" href="/tags/data-science">Data Science</a>
                &middot;
                
                
                <a class="article-category-link" href="/tags/events">events</a>
                &middot;
                
                
                <a class="article-category-link" href="/tags/r-markdown">R markdown</a>
                &middot;
                
                
                <a class="article-category-link" href="/tags/latex">LaTeX</a>
                &middot;
                
                
                <a class="article-category-link" href="/tags/r-language">R language</a>
                
                
            </div>
            
        
    </div>
</header>

        <div class="article-entry" itemprop="articleBody">
            <p><em>Saghir Bashir <a href="http://www.ilustat.com/">(www.ilustat.com)</a></em></p>
<p>Sometimes after an event you need to issue certificates to the participants. How do you normally produce several certificates automatically? There are different ways to do it and here we share our approach after a recent community event<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a>. We used R to automatically generate the certificates using R markdown and LaTeX language.</p>
<div id="objective" class="section level2">
<h2>Objective</h2>
<p>The key objective was to produce PDF certificates that could be emailed to attendees (see above for an example).</p>
</div>
<div id="how-did-it-work" class="section level2">
<h2>How did it work?</h2>
<p>We started with a certificate template in R markdown format (with LateX) containing the following tags <code>&lt;&lt;ATTENDEE_NAME&gt;&gt;</code>, <code>&lt;&lt;EVENT_NAME&gt;&gt;</code>, <code>&lt;&lt;EVENT_DATE&gt;&gt;</code> and <code>&lt;&lt;EVENT_LOCATION&gt;&gt;</code>. These tags were replaced by attendee and event information from a <code>data.frame</code>. The PDF certificates were produced using <code>rmarkdown::render()</code> whilst looping over the attendee <code>data.frame</code>.</p>
</div>
<div id="requirements" class="section level2">
<h2>Requirements</h2>
<ol style="list-style-type: decimal">
<li><p>A fixed working directory using <code>set_here()</code><a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a>.</p></li>
<li><p>Dataset with attendee and event (name, date and location) information.</p></li>
<li><p>A certificate template in R markdown format.</p></li>
</ol>
</div>
<div id="set-up" class="section level2">
<h2>Set up</h2>
<pre class="r"><code>library(tidyverse)
library(rmarkdown)
library(stringr)
library(here)

set_here() # Need this later especially when rendering R markdown</code></pre>
</div>
<div id="dataset-of-attendees" class="section level2">
<h2>Dataset of Attendees</h2>
<p>Let assume that our dataset of attendees is as follow:</p>
<pre class="r"><code>attendees &lt;- read_csv(here(&quot;AttendeeList.csv&quot;)) %&gt;%
  mutate(filePDF = str_c(&quot;PDF/&quot;, row_number(), &quot;_&quot;,
                         str_replace_all(Name, fixed(&quot; &quot;), &quot;_&quot;), &quot;.pdf&quot;)) %&gt;%
  select(filePDF, Name, Event, Date, Location)</code></pre>
<pre><code>## Warning: package &#39;bindrcpp&#39; was built under R version 3.4.4</code></pre>
<pre class="r"><code>attendees</code></pre>
<pre><code>## # A tibble: 3 x 5
##   filePDF                 Name          Event            Date              Location      
##   &lt;chr&gt;                   &lt;chr&gt;         &lt;chr&gt;            &lt;chr&gt;             &lt;chr&gt;         
## 1 PDF/1_Nina_Maccari.pdf  Nina Maccari  Tidyverse Basics 6th February 2018 Lisbon, Portu…
## 2 PDF/2_Don_Leonardo.pdf  Don Leonardo  Tidyverse Basics 6th February 2018 Lisbon, Portu…
## 3 PDF/3_Eva_Jane_Rhys.pdf Eva Jane Rhys Advanced ggplot2 9th February 2018 Lisbon, Portu…</code></pre>
</div>
<div id="certificate-template" class="section level2">
<h2>Certificate Template</h2>
<p>Next we developed a certificate template using R markdown, with tags (i.e. <code>&lt;&lt; ... &gt;&gt;</code>) for the attendee and event information. Our template is saved in a file called <code>Certificate_Rmd_Template.txt</code>:</p>
<pre class="r"><code>---
title: &#39;&#39;
output: pdf_document
latex_engine: xelatex
classoption: landscape
header-includes:
- \renewcommand{\familydefault}{\sfdefault}
---

\pagenumbering{gobble}

\begin{center}
  {\Huge\bf Certificate of Attendance} \\
  \vfill
  {\Huge\bf &lt;&lt;ATTENDEE_NAME&gt;&gt;} \\
  \vfill
  {\Huge\it &lt;&lt;EVENT_NAME&gt;&gt;}
  \bigskip \\
  {\Large\it  &lt;&lt;EVENT_DATE&gt;&gt;}
  \bigskip \\
  {\Large\it &lt;&lt;EVENT_LOCATION&gt;&gt;} \\
\end{center}

\vfill

\begin{center}
\includegraphics[height=4cm]{images/Rlogo.png}
\includegraphics[height=4cm]{images/NotHexLogo.png}
\end{center}</code></pre>
</div>
<div id="certificate-generation" class="section level2">
<h2>Certificate Generation</h2>
<p>The certificates were generated using a function that combines the previous steps. The comments in the function code below describe what is going on.</p>
<pre class="r"><code>certificate &lt;- function(template, attendeeName, event, eDate, eLocation, outPDF, knitDir){
  cat(&quot;\n Starting:&quot;, outPDF, &quot;\n&quot;)

  # Create a temporary Rmd file with the attendee and event information.  
  templateCert &lt;- read_file(template)
  tmpRmd &lt;- templateCert %&gt;%
    str_replace(&quot;&lt;&lt;ATTENDEE_NAME&gt;&gt;&quot;, attendeeName) %&gt;%
    str_replace(&quot;&lt;&lt;EVENT_NAME&gt;&gt;&quot;, event) %&gt;%
    str_replace(&quot;&lt;&lt;EVENT_DATE&gt;&gt;&quot;, eDate) %&gt;%
    str_replace(&quot;&lt;&lt;EVENT_LOCATION&gt;&gt;&quot;, eLocation)
  
  # The knitdir has to be defined for the rmarkdown::render to work.
  RmdFile &lt;- tempfile(tmpdir = knitDir, fileext = &quot;.Rmd&quot;)
  write_file(tmpRmd, RmdFile)

  # Creating the certificates using R markdown.
  rmarkdown::render(RmdFile, output_file = here(outPDF), quiet = TRUE)
  
  # Temporary .Rmd file can be deleted.
  file.remove(RmdFile)
  cat(&quot;\n Finished:&quot;, outPDF, &quot;\n&quot;)
}</code></pre>
<p>Now we can create all the certificates by looping over the attendee <code>data.frame</code>.</p>
<pre class="r"><code>for (i in seq_len(nrow(attendees))) {
  with(attendees,
       certificate(template = here(&quot;Certificate_Rmd_Tempate.txt&quot;),
                   Name[i], Event[i], Date[i], Location[i], filePDF[i], here())
  )
}</code></pre>
<pre><code>## 
##  Starting: PDF/1_Nina_Maccari.pdf 
## 
##  Finished: PDF/1_Nina_Maccari.pdf 
## 
##  Starting: PDF/2_Don_Leonardo.pdf 
## 
##  Finished: PDF/2_Don_Leonardo.pdf 
## 
##  Starting: PDF/3_Eva_Jane_Rhys.pdf 
## 
##  Finished: PDF/3_Eva_Jane_Rhys.pdf</code></pre>
<p>You can view the PDF certificates:</p>
<ul>
<li><a href="/blog/PDF/1_Nina_Maccari.pdf">1_Nina_Maccari.pdf</a></li>
<li><a href="/blog/PDF/2_Don_Leonardo.pdf">2_Don_Leonardo.pdf</a></li>
<li><a href="/blog/PDF/3_Eva_Jane_Rhys.pdf">3_Eva_Jane_Rhys.pdf</a></li>
</ul>
</div>
<div id="summary" class="section level2">
<h2>Summary</h2>
<p>We have presented a way to create PDF certificates of attendance based on a user defined “template”. The template was populated with the attendee and event information from which PDF certificates were generated using R markdown. This approach can be used to produce other types of documents, for example, “mail merges” and setting different exercises or exams for students. Our code can be run directly from the R console or as a batch job thanks to the <code>rmarkdown</code> and <code>here</code> packages.</p>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p><a href="dsup.org">Data Science Unplugged</a>: “Data Science in Practice” <a href="https://www.meetup.com/Data-Science-Unplugged/events/246963169/">Event</a><a href="#fnref1">↩</a></p></li>
<li id="fn2"><p>See <a href="https://www.tidyverse.org/articles/2017/12/workflow-vs-script/">Jenny Bryan’s excellent article</a> about using the <code>here</code> package<a href="#fnref2">↩</a></p></li>
</ol>
</div>

        </div>
        <footer class="article-footer">
    <a data-url="/blog/creating-certificates-of-attendance-using-r/" data-id="edea8d9c85fea0754e938c6e4dc6bf73" class="article-share-link">
        <i class="fa fa-share"></i>
        Share
    </a>
    

    <script>
    (function ($) {
        
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = location.protocol + '//' + location.host + $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fa fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fa fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fa fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fa fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
    </script>
</footer>

    </div>

    
<nav id="article-nav">
    
    <a href="/blog/data-science-education-some-thoughts/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">
          Older
      </strong>
      <div class="article-nav-title">Data Science Education: Some Thoughts</div>
    </a>
    

    
    <a href="/blog/learning-r-vs-learning-a-spoken-language/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">
          Newer
      </strong>
      <div class="article-nav-title">Learning R vs Learning a Spoken Language</div>
    </a>
    
</nav>


</article>



    </section>

   	
    	<aside id="sidebar">
    

    


<div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
        <ul class="category-list">
            
            <li class="category-list-item">
                
                <a class="category-list-link" href="/categories/blog">
                    blog
                </a>
                <span class="category-list-count">3</span>
            </li>
            
            <li class="category-list-item">
                
                <a class="category-list-link" href="/categories/events">
                    events
                </a>
                <span class="category-list-count">1</span>
            </li>
            
        </ul>
    </div>
</div>




    


<div class="widget-wrap">
    <h3 class="widget-title">
        Tags
    </h3>
    <div class="widget">
        <ul class="category-list">
            
            <li class="category-list-item">
                
                <a class="category-list-link" href="/tags/accessibility">
                    accessibility
                </a>
                <span class="category-list-count">1</span>
            </li>
            
            <li class="category-list-item">
                
                <a class="category-list-link" href="/tags/data-science">
                    data-science
                </a>
                <span class="category-list-count">4</span>
            </li>
            
            <li class="category-list-item">
                
                <a class="category-list-link" href="/tags/events">
                    events
                </a>
                <span class="category-list-count">2</span>
            </li>
            
            <li class="category-list-item">
                
                <a class="category-list-link" href="/tags/latex">
                    latex
                </a>
                <span class="category-list-count">1</span>
            </li>
            
            <li class="category-list-item">
                
                <a class="category-list-link" href="/tags/learning">
                    learning
                </a>
                <span class="category-list-count">3</span>
            </li>
            
            <li class="category-list-item">
                
                <a class="category-list-link" href="/tags/r-language">
                    r-language
                </a>
                <span class="category-list-count">3</span>
            </li>
            
            <li class="category-list-item">
                
                <a class="category-list-link" href="/tags/r-markdown">
                    r-markdown
                </a>
                <span class="category-list-count">1</span>
            </li>
            
            <li class="category-list-item">
                
                <a class="category-list-link" href="/tags/statistics">
                    statistics
                </a>
                <span class="category-list-count">1</span>
            </li>
            
            <li class="category-list-item">
                
                <a class="category-list-link" href="/tags/teaching">
                    teaching
                </a>
                <span class="category-list-count">1</span>
            </li>
            
        </ul>
    </div>
</div>




    


    <div id="toTop" class="fa fa-angle-up"></div>
</aside>

    
	</div>
</div>

<footer id="footer">
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018
      Powered by <a href="//gohugo.io">Hugo</a>. Theme by <a href="http://github.com/ppoffice">PPOffice</a>.
    </div>
  </div>
</footer>


<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script src="/js/script.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>


<script>hljs.initHighlightingOnLoad();</script>


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']]}
  });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>




</body>
</html>